# AI Agent Integration Example

This example demonstrates the integration between the `olca` AI agent system and the music generation pipeline, showcasing interactive, conversational music creation.

## Overview

**Purpose**: Interactive AI-driven music composition using LangChain agents
**Features**: Conversational music development, dynamic prompt generation, multi-turn musical exploration
**Integration**: Combines `olca` agent with `ohfi` inference and ABC processing

## Components

### 1. AI Agent Configuration
- `olca.yml` - LangChain agent configuration with music-focused system instructions
- OpenAI GPT-4 integration with tool access
- LangSmith tracing for debugging and optimization

### 2. Music Generation Pipeline
- `orpheus-config.yml` - HuggingFace endpoint for ChatMusician
- Dynamic prompt generation through agent conversation
- Automated ABC extraction and music format conversion

### 3. Interactive Workflow
- Conversational music composition
- Real-time feedback and iteration
- Musical concept exploration through dialogue

## Files in this Example

### Configuration Files
- `olca.yml` - AI agent system configuration
- `orpheus-config.yml` - HuggingFace inference setup
- `conversation_starters.md` - Example conversation prompts

### Generated During Interaction
- Agent conversation logs (if tracing enabled)
- Dynamic `musical.yml` files generated by agent
- Complete music output pipeline (JSON/ABC/MIDI/MP3/Score)

## Setup Instructions

### 1. Environment Setup
```bash
# Set OpenAI API key for the agent
export OPENAI_API_KEY__o450olca241128="your_openai_key_here"

# Set HuggingFace API key for music generation
export HUGGINGFACE_API_KEY="your_hf_key_here"

# Enable LangSmith tracing (optional but recommended)
export LANGCHAIN_API_KEY="your_langsmith_key_here"
```

### 2. Navigation and Execution
```bash
cd examples/ai-agent-integration/

# Start the interactive AI agent with tracing
olca -T
```

## Example Conversations

### Conversation 1: Guided Music Creation
```
User: "I want to create a peaceful piano piece in the style of Ludovico Einaudi"

Agent: "I'll help you create a peaceful piano piece inspired by Einaudi's style. Let me guide you through the process:

1. First, let's establish the musical characteristics:
   - Key: Something warm and contemplative, perhaps A minor or F major?
   - Tempo: Slow, around 60-80 BPM
   - Structure: Simple, repetitive patterns with gradual development
   - Harmony: Minimal, with emphasis on melody and space

What key would you prefer, and do you have any specific emotions or imagery in mind?"

User: "Let's use A minor, and I want it to evoke a quiet morning by a lake"

Agent: "Perfect! A minor works beautifully for that serene, contemplative mood. Now I'll create a musical prompt and generate the piece for you using our music AI pipeline..."

[Agent then creates musical.yml and runs ohfi internally]
```

### Conversation 2: Musical Education and Creation
```
User: "I'm learning about jazz harmony. Can you help me understand ii-V-I progressions while creating examples?"

Agent: "Absolutely! The ii-V-I progression is fundamental to jazz harmony. Let me explain while we create examples:

The ii-V-I in C major would be:
- ii: Dm7 (D-F-A-C) - subdominant function
- V: G7 (G-B-D-F) - dominant function  
- I: Cmaj7 (C-E-G-B) - tonic resolution

Let me generate several examples in different keys so you can hear how this progression works..."

[Agent creates multiple ii-V-I examples and processes them]
```

### Conversation 3: Collaborative Composition
```
User: "I have a melody in my head but I need help with the harmonization"

Agent: "I'd love to help you harmonize your melody! Can you describe it to me? For example:
- What key is it in?
- How does it move (stepwise, jumps, rhythmic pattern)?
- What's the overall mood or character?
- Can you hum or describe the contour?

Once I understand your melody, I can suggest appropriate chord progressions and create a full arrangement."
```

## Agent Capabilities

The `olca` agent in this example can:

### 1. Musical Analysis
- Analyze existing compositions
- Explain harmonic progressions
- Identify musical styles and techniques
- Provide music theory education

### 2. Creative Assistance
- Generate musical ideas and prompts
- Suggest chord progressions and melodies
- Help with arrangement and orchestration
- Provide stylistic guidance

### 3. Technical Integration
- Create `musical.yml` configurations dynamically
- Execute `ohfi` command for music generation
- Process generated ABC files
- Coordinate the complete music creation pipeline

### 4. Educational Support
- Explain music theory concepts
- Provide historical and stylistic context
- Suggest practice exercises
- Guide learning progression

## Configuration Details

### olca.yml
```yaml
api_keyname: OPENAI_API_KEY__o450olca241128
human: true
model_name: gpt-4o-mini
recursion_limit: 300
temperature: 0.7
tracing: true
system_instructions: |
  You are a professional music composer and educator AI agent with access to advanced music generation tools.
  
  Your capabilities include:
  - Music theory analysis and education
  - Creative composition assistance
  - Integration with ChatMusician AI for music generation
  - ABC notation processing and multi-format music output
  
  When users request music creation:
  1. Engage in dialogue to understand their musical vision
  2. Create appropriate prompts for the music AI
  3. Generate musical.yml configurations
  4. Execute the music generation pipeline
  5. Provide educational context about the generated music
  
  Always be encouraging, educational, and technically precise while maintaining creative enthusiasm.

user_input: "Hello! I'm ready to explore music creation with AI. What would you like to work on today?"
```

## Advanced Workflows

### 1. Iterative Composition
```bash
# Start agent session
olca -T

# In conversation, develop a piece through multiple iterations:
# "Create a basic chord progression" → "Add a melody" → "Develop variations" → "Create a full arrangement"
```

### 2. Educational Exploration
```bash
# Use the agent to learn while creating:
# "Teach me about modal harmony while we compose in Dorian mode"
# "Explain counterpoint as we create a Bach-style invention"
```

### 3. Style Analysis and Recreation
```bash
# Analyze and recreate musical styles:
# "Analyze this piece [paste ABC] and help me create something similar"
# "What makes Chopin's style distinctive? Let's compose in that style"
```

## Troubleshooting

### Agent Issues
- Ensure OpenAI API key is correctly set
- Verify `olca.yml` configuration syntax
- Check LangChain and related dependencies are installed

### Music Generation Integration
- Confirm HuggingFace endpoint is available and running
- Verify the agent can write files (permissions)
- Test `ohfi` command independently first

### Conversation Quality
- Adjust temperature in `olca.yml` for more/less creative responses
- Modify system instructions for different musical focuses
- Use specific musical terminology for better results

## Educational Benefits

This integration teaches:
1. **Interactive AI Usage**: How to have productive conversations with AI agents
2. **Musical AI Integration**: Combining different AI tools for complex workflows
3. **Prompt Engineering**: Developing effective prompts through dialogue
4. **Music Theory Application**: Learning theory through practical composition
5. **Creative Process**: Understanding AI-assisted creative workflows

## Next Steps

After mastering agent integration:
1. Customize system instructions for specific musical styles
2. Create specialized agents for different musical tasks
3. Integrate with other orpheuspypractice tools
4. Develop your own musical AI workflows
5. Explore advanced LangChain features for music applications